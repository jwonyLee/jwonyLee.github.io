<h1 id="ios-ì»¬ë ‰ì…˜ë·°ì—-ë±ƒì§€-ì¶”ê°€í•˜ê¸°">[iOS] ì»¬ë ‰ì…˜ë·°ì— ë±ƒì§€ ì¶”ê°€í•˜ê¸°</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ğŸ¯ Compositional Layoutì„ ì´ìš©í•´ ì»¬ë ‰ì…˜ë·°ì— ë±ƒì§€ ì¶”ê°€í•˜ê¸°
</code></pre></div></div>

<p>êµ¬í˜„í•˜ë ¤ëŠ” ëª¨ì–‘ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p><img src="badge-1.png" alt="êµ¬í˜„í•˜ë ¤ëŠ” ëª¨ì–‘" /></p>

<p>ê°€ìš´ë°ì—ëŠ” ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•˜ê³  ìš°ì¸¡ ìƒë‹¨ì—ëŠ” ë±ƒì§€ í˜•íƒœì˜ ë²„íŠ¼ì„ ë„£ëŠ” í˜•íƒœë‹¤. ê·¸ë¦¬ê³  ì´ëŸ° êµ¬ì„±ì€ Compositonal layoutì„ ì´ìš©í•˜ë©´ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<h2 id="compositional-layout">Compositional Layout</h2>

<p>iOS 13.0 ë¶€í„° ë„ì…ëœ UICollectionView ë ˆì´ì•„ì›ƒì˜ ìƒˆë¡œìš´ ë°©ì‹ì´ë‹¤. ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ UICollectionViewFlowLayout ë³´ë‹¤ ì¡°ê¸ˆ ë” ë§ì€ ê±¸ ì§€ì›í•˜ëŠ”ë° ìì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒì—â€¦ (ê¸°ì•½ì—†ëŠ” ì•½ì†)</p>

<p>ì•„ë¬´íŠ¼, Compositional Layoutì„ ì´ìš©í•˜ë©´ ë±ƒì§€ë¥¼ ê°€ì§„ ì…€ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ë±ƒì§€ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">UICollectionReusableView</code>ë¥¼ ì„œë¸Œ í´ë˜ì‹±í•´ì„œ ë±ƒì§€ë¥¼ êµ¬í˜„í•œë‹¤.</li>
  <li>UICollectionView ì— ì‚¬ìš©í•  ë±ƒì§€ë¥¼ ë“±ë¡í•œë‹¤.</li>
  <li>Compositional Layoutì„ ì´ìš©í•´ ë±ƒì§€ë¥¼ í¬í•¨í•œ ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•œë‹¤.</li>
  <li>ì…€ì„ ê·¸ë¦°ë‹¤.</li>
</ol>

<h2 id="uicollectionreusableview">UICollectionReusableView</h2>

<blockquote>
  <p>A view that defines the behavior for all cells and supplementary views presented by a collection view.</p>
</blockquote>

<blockquote>
  <p>ì»¬ë ‰ì…˜ë·°ì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“  ì…€ê³¼ ë³´ì¡° ë·°ì— ëŒ€í•œ ë™ì‘ì„ ì •ì˜í•˜ëŠ” ë·°ì…ë‹ˆë‹¤.</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">CloseButtonView</span><span class="p">:</span> <span class="kt">UICollectionReusableView</span> <span class="p">{</span>
    <span class="c1">// MARK: View</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">button</span><span class="p">:</span> <span class="kt">UIButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">button</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">()</span>
        <span class="n">button</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="n">button</span><span class="o">.</span><span class="nf">setImage</span><span class="p">(</span><span class="kt">SwiftGenAssets</span><span class="o">.</span><span class="n">closeBadge</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">button</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">configure</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Not implemented"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">CloseButtonView</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>

        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">button</span><span class="o">.</span><span class="n">centerXAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">centerXAnchor</span><span class="p">),</span>
            <span class="n">button</span><span class="o">.</span><span class="n">centerYAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">centerYAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ë²„íŠ¼ í•˜ë‚˜ë§Œ ì´ìš©í•´ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì—ˆë‹¤. ë©”ì¸ìœ¼ë¡œ ê·¸ë ¤ì§€ëŠ” ì…€ì˜ ë³´ì¡° ë·°ë¼ì„œ ë§ì€ ê±¸ ë‹´ê¸°ì— ì í•©í•˜ì§€ë„ ì•Šë‹¤. (ë‡Œí”¼ì…œ)</p>

<h2 id="uicollectionviewregister_forsupplementaryviewofkindwithreusepermalink">UICollectionView.register(_:forSupplementaryViewOfKind:withReusepermalink:)</h2>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">register</span><span class="p">(</span><span class="n">_</span> <span class="nv">viewClass</span><span class="p">:</span> <span class="kt">AnyClass</span><span class="p">?,</span>
              <span class="n">forSupplementaryViewOfKind</span> <span class="nv">elementKind</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> 
              <span class="n">withReuseIdentifier</span> <span class="nv">permalink</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>
</code></pre></div></div>

<p>êµ¬í˜„í•œ ë±ƒì§€ë¥¼ ì»¬ë ‰ì…˜ ë·°ì— ë“±ë¡í•œë‹¤. ì»¤ìŠ¤í…€ ì…€ ë“±ë¡í•  ë•Œ ì“°ëŠ” <code class="language-plaintext highlighter-rouge">register(_:forCellWithReusepermalink:)</code>ë‘ ë¹„ìŠ·í•˜ì§€ë§Œ <code class="language-plaintext highlighter-rouge">elementKind</code>ë¼ëŠ” ë§¤ê°œë³€ìˆ˜ê°€ í•˜ë‚˜ ë” ìˆë‹¤. ì•„ë˜ì—ë„ ë‚˜ì˜¤ê² ì§€ë§Œ ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•  ë•Œ ìƒì„±í–ˆë˜ <code class="language-plaintext highlighter-rouge">CloseButtonView</code>(ë±ƒì§€ í´ë˜ìŠ¤)ë¡œ ì§ì ‘ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì—¬ê¸°ì„œ ë“±ë¡í•˜ëŠ” <code class="language-plaintext highlighter-rouge">elementKind</code>ë¡œ êµ¬ë¶„í•˜ê¸° ë•Œë¬¸ì— ìœ ë‹ˆí¬í•œ ê°’ì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">collectionView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">CloseButtonView</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forSupplementaryViewOfKind</span><span class="p">:</span> <span class="s">"close-badge"</span><span class="p">,</span> <span class="nv">withReusepermalink</span><span class="p">:</span> <span class="s">"close-badge"</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">elementKind</code>ëŠ” Supplementary Item ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©í•˜ê³ , <code class="language-plaintext highlighter-rouge">identifier</code>ëŠ” ì»¬ë ‰ì…˜ ë·°ì—ì„œ ì…€ ì¬í™œìš©í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ê±°ë¼ì„œ ê°™ì€ ê°’ì„ ë„£ì–´ë„ ìƒê´€ì—†ë‹¤.</p>

<h2 id="compositional-layoutì„-ì´ìš©í•´-ë ˆì´ì•„ì›ƒ-êµ¬ì„±">Compositional Layoutì„ ì´ìš©í•´ ë ˆì´ì•„ì›ƒ êµ¬ì„±</h2>

<p><a href="https://developer.apple.com/documentation/uikit/views_and_controls/collection_views/implementing_modern_collection_views">Implementing Modern Collection Views</a>ì—ì„œ <strong>Add Badges to Items</strong> í•­ëª©ì„ ë³´ë©´ ì–´ë–»ê²Œ êµ¬ì„±í•˜ëŠ” ì§€ ë‚˜ì™€ìˆë‹¤.</p>

<p>ì˜ˆì‹œë¡œ ë‚˜ì™€ìˆëŠ” ë ˆì´ì•„ì›ƒ êµ¬ì„± ì½”ë“œë¥¼ í•œ ì¤„ì”© ë³´ìë©´,</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">badgeAnchor</span> <span class="o">=</span> <span class="kt">NSCollectionLayoutAnchor</span><span class="p">(</span><span class="nv">edges</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="o">.</span><span class="n">trailing</span><span class="p">],</span> <span class="nv">fractionalOffset</span><span class="p">:</span> <span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">))</span> <span class="c1">// 1</span>
<span class="k">let</span> <span class="nv">badgeSize</span> <span class="o">=</span> <span class="kt">NSCollectionLayoutSize</span><span class="p">(</span><span class="nv">widthDimension</span><span class="p">:</span> <span class="o">.</span><span class="nf">absolute</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
                                      <span class="nv">heightDimension</span><span class="p">:</span> <span class="o">.</span><span class="nf">absolute</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="c1">// 2</span>
<span class="k">let</span> <span class="nv">badge</span> <span class="o">=</span> <span class="kt">NSCollectionLayoutSupplementaryItem</span><span class="p">(</span>
    <span class="nv">layoutSize</span><span class="p">:</span> <span class="n">badgeSize</span><span class="p">,</span>
    <span class="nv">elementKind</span><span class="p">:</span> <span class="kt">ItemBadgeSupplementaryViewController</span><span class="o">.</span><span class="n">badgeElementKind</span><span class="p">,</span>
    <span class="nv">containerAnchor</span><span class="p">:</span> <span class="n">badgeAnchor</span><span class="p">)</span> <span class="c1">// 3</span>

<span class="k">let</span> <span class="nv">itemSize</span> <span class="o">=</span> <span class="kt">NSCollectionLayoutSize</span><span class="p">(</span><span class="nv">widthDimension</span><span class="p">:</span> <span class="o">.</span><span class="nf">fractionalWidth</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                                     <span class="nv">heightDimension</span><span class="p">:</span> <span class="o">.</span><span class="nf">fractionalHeight</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="k">let</span> <span class="nv">item</span> <span class="o">=</span> <span class="kt">NSCollectionLayoutItem</span><span class="p">(</span><span class="nv">layoutSize</span><span class="p">:</span> <span class="n">itemSize</span><span class="p">,</span> <span class="nv">supplementaryItems</span><span class="p">:</span> <span class="p">[</span><span class="n">badge</span><span class="p">])</span> <span class="c1">// 4</span>
<span class="n">item</span><span class="o">.</span><span class="n">contentInsets</span> <span class="o">=</span> <span class="kt">NSDirectionalEdgeInsets</span><span class="p">(</span><span class="nv">top</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nv">leading</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nv">bottom</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="nv">trailing</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<ol>
  <li><code class="language-plaintext highlighter-rouge">NSCollectionLayoutAnchor</code>ëŠ” ì»¬ë ‰ì…˜ ë·°ì˜ Supplementary Itemì˜ ìœ„ì¹˜ë¥¼ ì •ì˜í•˜ëŠ” ê°ì²´ë‹¤. ì•„ë˜ ì‚¬ì§„ì€ ê°’ì— ë”°ë¼ ì–´ë–»ê²Œ ë°°ì¹˜ë˜ëŠ” ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì˜¤í”„ì…‹ì€ <code class="language-plaintext highlighter-rouge">fractionalOffset</code>ê³¼ <code class="language-plaintext highlighter-rouge">absoluteOffset</code>ìœ¼ë¡œ ë‚˜ë‰œë‹¤.<br />
 <img src="badge-2.png" alt="NSCollectionLayoutAnchor ë°°ì¹˜" /></li>
  <li>ë±ƒì§€ì˜ í¬ê¸°ë¥¼ ì§€ì •í•œë‹¤. ì—¬ê¸°ì„œëŠ” 20 ë§Œí¼ì˜ ì ˆëŒ€ê°’ìœ¼ë¡œ ì§€ì •í–ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">NSCollectionLayoutSupplementaryItem</code> ê°ì²´ë¥¼ ìƒì„±í•œë‹¤. ì—¬ê¸°ì„œ <code class="language-plaintext highlighter-rouge">elementKind</code>ë¡œ ë“¤ì–´ê°€ëŠ” ê°’ì€ ì»¬ë ‰ì…˜ ë·°ì— ë“±ë¡í•  ë•Œ ì‚¬ìš©í–ˆë˜ <code class="language-plaintext highlighter-rouge">elementKind</code>ë‘ ê°™ì€ ê°’ì„ ì‘ì„±í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">supplementaryItems</code>ì— 3ì—ì„œ ìƒì„±í•œ SupplementaryItemì„ ë„£ëŠ”ë‹¤.</li>
</ol>

<p>ì˜ˆì‹œ ì½”ë“œì™€ ì‹¤ì œ ë ˆì´ì•„ì›ƒ êµ¬ì„±í•˜ëŠ” ë¶€ë¶„ì€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šì•„ì„œ ìƒëµí•œë‹¤.</p>

<h2 id="ì…€ì„-ê·¸ë¦°ë‹¤">ì…€ì„ ê·¸ë¦°ë‹¤.</h2>

<p>ì¼ë°˜ì ìœ¼ë¡œ ì…€ ê·¸ë¦¬ëŠ” ê±°ë‘ ë˜‘ê°™ì´ ê·¸ë ¤ì£¼ë©´ ëœë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">collectionView</span><span class="p">(</span><span class="n">_</span> <span class="nv">collectionView</span><span class="p">:</span> <span class="kt">UICollectionView</span><span class="p">,</span> <span class="n">viewForSupplementaryElementOfKind</span> <span class="nv">kind</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="n">at</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UICollectionReusableView</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">badge</span> <span class="o">=</span> <span class="n">collectionView</span><span class="o">.</span><span class="nf">dequeueReusableSupplementaryView</span><span class="p">(</span><span class="nv">ofKind</span><span class="p">:</span> <span class="kt">CloseButtonView</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">,</span> <span class="nv">withReusepermalink</span><span class="p">:</span> <span class="kt">CloseButtonView</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">CloseButtonView</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">CloseButtonView</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">badge</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ í•˜ë©´ ë!!!! ì¸ë° ì•„ì£¼ í° ë¬¸ì œê°€ ìˆë‹¤.</p>

<p>ë‚˜ëŠ” ì»¬ë ‰ì…˜ ë·°ë¥¼ ê°€ë¡œë¡œ ìŠ¤í¬ë¡¤í•˜ê¸° ìœ„í•´ì„œ <code class="language-plaintext highlighter-rouge">section.orthogonalScrollingBehavior</code>ë¥¼ ì‚¬ìš©í–ˆëŠ”ë°, ì´ê±¸ ì‚¬ìš©í•˜ë©´ ë·°ì˜ ê³„ì¸µ êµ¬ì¡°ê°€ ì—‰ë§ì´ ë˜ë²„ë ¤ì„œ Supplementary Viewê°€ ì œëŒ€ë¡œ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p><img src="badge-3.png" alt="ê³„ì¸µ êµ¬ì¡°ê°€ ê¹¨ì§„ ëª¨ìŠµ" /></p>

<p><code class="language-plaintext highlighter-rouge">orthogonalScrollingBehavior</code>ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì •ìƒì ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.</p>

<p><img src="badge-4.png" alt="ì •ìƒì ìœ¼ë¡œ ë³´ì´ëŠ” ëª¨ìŠµ" /></p>

<p>ì•Œë ¤ì£¼ì‹  í˜„ìˆ˜ë‹˜ê»˜ ë¬´í•œí•œ ê°ì‚¬ì˜ ë§ì”€ì„ ë“œë¦¬ë©°â€¦ ğŸ™</p>

<p>ê²°êµ­ ìµœì¢… êµ¬í˜„ë¬¼ì—ì„œëŠ” ì…€ ì•ˆì— ë²„íŠ¼ ë§Œë“œëŠ” ë°©ì‹ìœ¼ë¡œ ë°”ê¿¨ë‹¤. ì´ëŸ¬ë©´ ë¬´ìŠ¨ ì†Œìš©ì´ëƒê³  ğŸ¤¦â€â™‚ï¸</p>

<h2 id="ì°¸ê³ -ìë£Œ">ì°¸ê³  ìë£Œ</h2>

<ul>
  <li><a href="https://developer.apple.com/documentation/uikit/views_and_controls/collection_views/implementing_modern_collection_views">Implementing Modern Collection Views - Apple Developer Documentation</a></li>
  <li><a href="https://developer.apple.com/documentation/uikit/uicollectionviewcompositionallayout">UICollectionViewCompositionalLayout - Apple Developer Documentation</a></li>
  <li><a href="https://developer.apple.com/documentation/uikit/nscollectionlayoutsupplementaryitem">NSCollectionLayoutSupplementaryItem - Apple Developer Documentation</a></li>
  <li><a href="https://developer.apple.com/documentation/uikit/nscollectionlayoutanchor">NSCollectionLayoutAnchor - Apple Developer Documentation</a></li>
  <li><a href="https://developer.apple.com/documentation/uikit/uicollectionview/1618103-register">register(_:forSupplementaryViewOfKind:withReusepermalink:) - Apple Developer Documentation</a></li>
  <li><a href="https://developer.apple.com/documentation/uikit/uicollectionreusableview">UICollectionReusableView - Apple Developer Documentation</a></li>
</ul>

<h2 id="íƒœê·¸">íƒœê·¸</h2>

<p>#iOS/UICollectionView #iOS/UICollectionView/Compositional_Layout</p>
