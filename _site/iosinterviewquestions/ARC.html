<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="BHx56ioY5NM_mqKgwinDWGi4RQizKJy-sfs5OLeYPV0" />

    <title>ARC란 무엇인지 설명하시오.</title>
    <meta name="description" content="RC(Reference Counting)">

    <!-- favicon -->
    <link href="/assets/favicon.ico" rel="icon" type="image/ico" />

    <!-- Tabler -->
    <script src="https://unpkg.com/@tabler/core@1.0.0-beta3/dist/js/tabler.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@tabler/core@1.0.0-beta3/dist/css/tabler.min.css">

    <!-- github style -->
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Twitter Cards -->
	<meta name="twitter:title" content="ARC란 무엇인지 설명하시오.">
	<meta name="twitter:description" content="RC(Reference Counting)
">
	
	
	
	<meta name="twitter:card" content="summary">
	<meta name="twitter:image" content="https://jwonylee.github.io/images/">
	

	<!-- Open Graph -->
	<meta property="og:locale" content="">
	<meta property="og:type" content="article">
	<meta property="og:title" content="ARC란 무엇인지 설명하시오.">
	
	<meta name="og:image" content="https://jwonylee.github.io/images/">
	

	<meta property="og:description" content="RC(Reference Counting)
">
	<meta property="og:url" content="https://jwonylee.github.io/iosinterviewquestions/ARC">
	<meta property="og:site_name" content="🌩 먹구름">
</head>

<body>

    <header class="navbar navbar-expand-md navbar-light d-print-none">
    <div class="container-xl">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
            <span class="navbar-toggler-icon"></span>
        </button>
        <h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3">
            <a href="/" class="nav-link">
                🌩 먹구름
            </a>
        </h1>
        <div class="collapse navbar-collapse" id="navbar-menu">
            <div class="d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/about">
                            <span class="nav-link-icon d-md-none d-lg-inline-block">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                    <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
                                </svg>
                            </span>
                            <span class="nav-link-title">About</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/archive">
                            <span class="nav-link-icon d-md-none d-lg-inline-block">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <rect x="3" y="4" width="18" height="4" rx="2"></rect>
                                    <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10"></path>
                                    <line x1="10" y1="12" x2="14" y2="12"></line>
                                </svg>
                            </span>
                            <span class="nav-link-title">Archive</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/categories">
                            <span class="nav-link-icon d-md-none d-lg-inline-block">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-folder" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2"></path>
                                 </svg>
                            </span>
                            <span class="nav-link-title">Categories</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/tags">
                            <span class="nav-link-icon d-md-none d-lg-inline-block">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path
                                        d="M11 3l9 9a1.5 1.5 0 0 1 0 2l-6 6a1.5 1.5 0 0 1 -2 0l-9 -9v-4a4 4 0 0 1 4 -4h4">
                                    </path>
                                    <circle cx="9" cy="9" r="2"></circle>
                                </svg>
                            </span>
                            <span class="nav-link-title">Tags</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="my-2 my-md-0 flex-grow-1 flex-md-grow-0 order-first order-md-last">
            <form action="" method="get">
                <div class="input-icon">
                    <span class="input-icon-addon">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24"
                            height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <circle cx="10" cy="10" r="7"></circle>
                            <line x1="21" y1="21" x2="15" y2="15"></line>
                        </svg>
                    </span>
                    <input type="text" class="form-control" placeholder="Search" aria-label="Search in blog">
                </div>
            </form>
        </div>
    </div>
</header>

    <main>
        <div class="page-wrapper">
    <div class="container-xl">
        <div class="page-header d-print-none">
            <div class="row align-items-center">
                <div class="col">
                    <h2 class="page-title">ARC란 무엇인지 설명하시오.</h2>
                    <div class="text-muted mt-1">iOSInterviewquestions</div>
                </div>
                <div class="col-auto">
                    2021-01-26
                </div>
            </div>
        </div>
    </div>

    <div class="page-body">
        <div class="container-xl">
            <div class="card card-lg">
                <div class="card-body markdown">
                        <h2 id="rcreference-counting">RC(Reference Counting)</h2>

<p>애플에서 메모리를 관리하는 방법</p>

<ul>
  <li>메모리를 할당하거나, 메모리 포인터를 <strong>참조</strong>할 때 레퍼런스 카운트 증가</li>
  <li>사용을 완료하면 레퍼런스 카운트 감소</li>
</ul>

<h2 id="mrcmanual-reference-counting">MRC(Manual Reference Counting)</h2>

<ul>
  <li>개발자가 직접 참조 관리</li>
</ul>

<h2 id="arcautomatic-reference-counting">ARC(Automatic Reference Counting)</h2>

<ul>
  <li>컴파일 타임에 자동으로 구문 분석 후 적절하게 레퍼런스 감소 코드 삽입</li>
  <li>실행 중에 별도의 메모리 관리가 이루어지지 않음</li>
  <li>참조 카운팅은 클래스의 <strong>인스턴스에만</strong> 적용
    <ul>
      <li>구조체와 열거체는 참조 타입이 아니라, 값 타입이라서 참조의 형태로 저장되거나 전달되지 않음</li>
      <li>값 타입(value type)은 스택이라는 정적 메모리 공간에 생기는 것이라서 메모리 관리의 대상이 아님</li>
    </ul>
  </li>
</ul>

<h3 id="arc의-작동-방식">ARC의 작동 방식</h3>

<p>클래스에 대한 인스턴스를 새로 생성할 때마다, ARC는 해당 인스턴스 정보를 저장하기 위한 메모리를 할당한다. 이 메모리는 해당 인스턴스의 타입 정보 및, 그 인스턴스와 결합된 모든 저장 속성의 값들을 함께 가지고 있다.</p>

<p>인스턴스가 더 이상 필요하지 않을 경우, ARC는 해당 인스턴스가 사용하고 있는 메모리를 해제하여 확보한다. 그 메모리는 다른 용도로 사용할 수 있고, 이는 클래스 인스턴스가 더 이상 필요없는 경우 메모리 공간을 차지하지 않음을 보장한다.</p>

<p>인스턴스가 필요한 동안에 해당 인스턴스가 사라지지 않게 하기 위해, ARC는 각각의 클래스 인스턴스를 참조하는 속성, 상수, 변수를 추적한다. ARC는 해당 인스턴스에 대한 활성화된(active) 참조가 하나라도 존재한다면 인스턴스의 할당을 해제하지 않는다.</p>

<p>이것을 가능하게 하기 위해, 클래스 인스턴스를 속성, 상수, 변수에 할당할 때마다, 해당 속성, 상수, 변수는 그 인스턴스에 대한 <strong>강한 참조(strong reference)</strong>를 만든다. 이 참조를 강한(strong) 참조라고 하는 이유는 이것이 해당 인스턴스를 꽉 쥐고 있어서, 해당 강한 참조가 남아 있는 동안 할당이 해제되는 것을 허용하지 않는다.</p>

<h3 id="클래스-인스턴스-사이의-강한-참조-순환">클래스 인스턴스 사이의 강한 참조 순환</h3>

<p>클래스 인스턴스에 대한 강한 참조를 없애는 것이 절대로(never) 안되는 경우가 있다. 이는 두 클래스 인스턴스가 서로에 대한 강한 참조를 쥐고 있어서, 각 인스턴스가 서로 계속 살아있게 될 때 발생한다. 이를 강한 참조 순환(strong reference cycle)이라고 한다.</p>

<p><img src="/assets/image/arc-1.png" alt="arc-1" /></p>

<p><img src="/assets/image/arc-2.png" alt="arc-2" /></p>

<p><code class="language-plaintext highlighter-rouge">john</code>과 <code class="language-plaintext highlighter-rouge">unit4A</code> 변수의 강한 참조를 끊더라도, 참조 개수는 0으로 떨어지지 않고, 인스턴스는 ARC에 의해 해제되지 않는다.</p>

<p>강한 참조 순환은 <code class="language-plaintext highlighter-rouge">Person</code>과 <code class="language-plaintext highlighter-rouge">Apartment</code> 인스턴스가 해제되는 것을 막으므로, 앱에서 메모리 누수를 발생시킨다. (<code class="language-plaintext highlighter-rouge">Person</code> 인스턴스와 <code class="language-plaintext highlighter-rouge">Apartment</code> 인스턴스 사이의 강한 참조가 남아 있으므로)</p>

<h3 id="클래스-인스턴스-사이의-강한-참조-순환-해결하기">클래스 인스턴스 사이의 강한 참조 순환 해결하기</h3>

<ul>
  <li>
    <p>약한 참조 (weak reference)</p>

    <p>다른 인스턴스의 수명이 더 짧을 때 사용한다. (다른 인스턴스의 할당이 먼저 해제되는 경우)</p>
  </li>
  <li>
    <p>무소속 참조 (unowned reference)
다른 인스턴스가 같거나 더 긴 수명을 가질 때 사용한다.</p>
  </li>
</ul>

<p>약한 참조와 무소속 참조는 참조 순환에 있는 인스턴스 하나가 다른 인스턴스를 강하게 쥐고 있지 않아도(without) 참조하도록 해준다. 이 인스턴스들은 강한 참조 순환을 생성하지 않아도 서로를 참조할 수 있다.</p>

<h3 id="weak-references-약한-참조">Weak References (약한 참조)</h3>

<p>참조하는 인스턴스를 강하게 쥐지 않는 참조 → ARC가 참조된 인스턴스를 처분하는 것을 중지하지 않음</p>

<blockquote>
  <p>ARC가 약한 참조를 <code class="language-plaintext highlighter-rouge">nil</code>로 설정할 때는 property observers가 호출되지 않는다.</p>
</blockquote>

<h3 id="unowned-references-무소속-참조">Unowned References (무소속 참조)</h3>

<p>다른 인스턴스가 같은 수명 또는 더 긴 수명을 가지고 있을 때 사용</p>

<p>항상 값을 가지고 있어야 하고, 옵셔널이 될 수 없으며, ARC는 절대로 무소속 참조의 값을 <code class="language-plaintext highlighter-rouge">nil</code>로 설정할 수 없음</p>

<blockquote>
  <p>무소속 참조는 해당 참조가 해제되지 않은 인스턴스만 항상 참조한다고 확신할 수 있을때만 사용
해당 인스턴스가 해제된 후에 무소속 참조의 값에 접근하려고 하면, 런타임 에러가 발생</p>
</blockquote>

<hr />

<h2 id="참고자료">참고자료</h2>

<ul>
  <li><a href="https://medium.com/ios-development-with-swift/프로퍼티-get-set-didset-willset-in-ios-a8f2d4da5514">프로퍼티 get, set, didSet, willSet in iOS</a></li>
  <li><a href="https://xho95.github.io/swift/language/grammar/property/2020/05/30/Properties.html">Swift 5.2: Properties (속성)</a></li>
  <li><a href="https://medium.com/@jang.wangsu/ios-swift-rc-arc-와-mrc-란-그리고-strong-weak-unowned-는-간단하게-적어봤습니다-988a293c04ac">[iOS Swift] RC, ARC 와 MRC 란? 그리고 Strong, Weak, Unowned 는? 간단하게 적어봤습니다.</a></li>
  <li><a href="https://xho95.github.io/swift/language/grammar/arc/automatic/reference/counting/2020/06/30/Automatic-Reference-Counting.html#fn:reference-type">Swift 5.3: Automatic Reference Counting (자동 참조 카운팅)</a></li>
</ul>

                </div>

                <div class="card-footer">
                    <div class="col mb-3">
                        
                        <div class="btn-list">
                            <span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-folder"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path
                                        d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2">
                                    </path>
                                </svg>
                                Category
                            </span>
                            
                            <a href="/categories#iOSInterviewquestions-ref"
                                class="btn btn-pill btn-sm" role="button">iOSInterviewquestions</a>
                            
                        </div>
                        
                    </div>
                    <div class="col">
                        
                        <div class="btn-list">
                            <span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag"
                                    width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path
                                        d="M11 3l9 9a1.5 1.5 0 0 1 0 2l-6 6a1.5 1.5 0 0 1 -2 0l-9 -9v-4a4 4 0 0 1 4 -4h4">
                                    </path>
                                    <circle cx="9" cy="9" r="2"></circle>
                                </svg>
                                Tags
                            </span>
                            
                            <a href="/tags#ARC" class="btn btn-pill btn-sm"
                                role="button">ARC</a>
                            
                            <a href="/tags#iOSInterviewquestions" class="btn btn-pill btn-sm"
                                role="button">iOSInterviewquestions</a>
                            
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    </main>
    <footer class="footer footer-transparent d-print-none">
    <div class="container">
        <div class="row text-center align-items-center flex-row-reverse">
            <div class="col-lg-auto ms-lg-auto">
                <ul class="list-inline list-inline-dots mb-0">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/jwonyLee" class="link-secondary">Github</a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://jwonylee.tistory.com" class="link-secondary">Blog</a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                <ul class="list-inline list-inline-dots mb-0">
                    <li class="list-inline-item">Copyright © 2021 jwonyLee. All rights reserved.</li>
                </ul>
            </div>
        </div>
    </div>
</footer>
</body>

</html>