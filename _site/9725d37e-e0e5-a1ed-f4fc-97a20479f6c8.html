<h1 id="ios-테이블뷰-셀-터치-후-다른-뷰로-이동한-뒤에-다시-돌아왔을-때-포커스-없애기">[iOS] 테이블뷰 셀 터치 후, 다른 뷰로 이동한 뒤에 다시 돌아왔을 때 포커스 없애기</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>📌 테이블 뷰 화면 이동 후 셀의 포커스가 남아있는 문제 해결하기
</code></pre></div></div>

<p><img src="tableview-focus.gif" alt="테이블 뷰 셀 포커스" /></p>

<p>셀을 선택해서 두 번째 뷰로 이동했다가 다시 첫 번째 뷰로 돌아와도 셀의 포커스가 남아있다. 처음에는 아래의 글을 참고하여 인터페이스 빌더의 Selection 옵션을 None으로 바꾸어줬었는데, 이러면 이동 후에 돌아와도 포커스가 남아있지 않지만, 문제는 터치할 때도 색상이 변하지 않는다는 거다. 이건 UX 측면에서 적합하지 못하다고 판단해서, 다른 방법을 찾아봤다.</p>

<p>애플 개발자 공식 문서에서 해결책을 찾았다.</p>

<blockquote>
  <p>If you respond to the cell selection by pushing a new view controller onto the navigation stack, deselect the cell when the view controller pops off the stack. If you’re using a UITableViewController to display a table view, you get the behavior by setting the clearsSelectionOnViewWillAppear property to true. Otherwise, you can clear the selection in your view controller’s viewWillAppear(_:) method:</p>
</blockquote>

<p>셀을 선택해서 새 뷰 컨트롤러를 네비게이션 스택에 push 하고 나서 다시 pop 할 때(= 원래 뷰로 돌아올 때) select 되어 있는 셀을 취소해야 한다. 취소하는 건 <code class="language-plaintext highlighter-rouge">viewWillAppear()</code>에서 처리하면 된다고 한다. 갔다가 다시 돌아오는 거니까 메모리엔 이미 뷰가 올라와있어서 <code class="language-plaintext highlighter-rouge">viewDidLoad()</code>에서 처리하는 건 적합하지 않다. 화면을 그리기 직전에 처리하는 게 적합하다.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">_</span> <span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">selectedIndexPath</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="n">indexPathForSelectedRow</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="o">.</span><span class="nf">deselectRow</span><span class="p">(</span><span class="nv">at</span><span class="p">:</span> <span class="n">selectedIndexPath</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="n">animated</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="참고-자료">참고 자료</h2>

<ul>
  <li><a href="https://ohgyun.com/641">iOS: 테이블뷰 셀 터치 시 포커스 남기지 않기 (TableViewCell SelectionStyle)</a></li>
</ul>
